\doxysection{Camera.\+h}
\hypertarget{Camera_8h_source}{}\label{Camera_8h_source}\index{include/igl/Camera.h@{include/igl/Camera.h}}
\mbox{\hyperlink{Camera_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ libigl,\ a\ simple\ c++\ geometry\ processing\ library.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Copyright\ (C)\ 2013\ Alec\ Jacobson\ <alecjacobson@gmail.com>}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla\ Public\ License\ }}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed\ with\ this\ file,\ You\ can\ }}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#ifndef\ IGL\_CAMERA\_H}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ IGL\_CAMERA\_H}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{comment}{//\ you're\ idiot,\ M\$!}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#undef\ far}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#undef\ near}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <Eigen/Geometry>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <Eigen/Core>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{PI_8h}{PI.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#define\ IGL\_CAMERA\_MIN\_ANGLE\ 5.0}}
\DoxyCodeLine{00022\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceigl}{igl}}}
\DoxyCodeLine{00023\ \{}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00032\ \ \ \textcolor{keyword}{class\ }Camera}
\DoxyCodeLine{00033\ \ \ \{}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \textcolor{comment}{//\ On\ windows\ you\ might\ need:\ -\/fno-\/delayed-\/template-\/parsing}}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \textcolor{comment}{//static\ constexpr\ double\ IGL\_CAMERA\_MIN\_ANGLE\ =\ 5.;}}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \textcolor{comment}{//\ \ m\_angle\ \ Field\ of\ view\ angle\ in\ degrees\ \{45\}}}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \textcolor{comment}{//\ \ m\_aspect\ \ Aspect\ ratio\ \{1\}}}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \textcolor{comment}{//\ \ m\_near\ \ near\ clipping\ plane\ \{1e-\/2\}}}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \textcolor{comment}{//\ \ m\_far\ \ far\ clipping\ plane\ \{100\}}}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \textcolor{comment}{//\ \ m\_at\_dist\ \ distance\ of\ looking\ at\ point\ \{1\}}}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \textcolor{comment}{//\ \ m\_orthographic\ \ whether\ to\ use\ othrographic\ projection\ \{false\}}}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \textcolor{comment}{//\ \ m\_rotation\_conj\ \ Conjugate\ of\ rotation\ part\ of\ rigid\ transformation\ of}}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ camera\ \{identity\}.\ Note:\ we\ purposefully\ store\ the\ conjugate\ because}}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ this\ is\ what\ TW\_TYPE\_QUAT4D\ is\ expecting.}}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \textcolor{comment}{//\ \ m\_translation\ \ Translation\ part\ of\ rigid\ transformation\ of\ camera}}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \{(0,0,1)\}}}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ m\_angle,\ m\_aspect,\ m\_near,\ m\_far,\ m\_at\_dist;}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_orthographic;}
\DoxyCodeLine{00050\ \ \ \ \ \ \ Eigen::Quaterniond\ m\_rotation\_conj;}
\DoxyCodeLine{00051\ \ \ \ \ \ \ Eigen::Vector3d\ m\_translation;}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ Camera();}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{virtual}\ \string~Camera()\{\}}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ projection\ matrix\ that\ takes\ relative\ camera\ coordinates\ and}}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \textcolor{comment}{//\ transforms\ it\ to\ viewport\ coordinates}}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \textcolor{comment}{//\ Note:}}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ if(m\_angle\ >\ 0)}}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ gluPerspective(m\_angle,m\_aspect,m\_near,m\_at\_dist+m\_far);}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \}else}}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ gluOrtho(-\/0.5*aspect,0.5*aspect,-\/0.5,0.5,m\_at\_dist+m\_near,m\_far);}}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \textcolor{comment}{//\ Is\ equivalent\ to}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ glMultMatrixd(projection().data());}}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ Eigen::Matrix4d\ projection()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ an\ Affine\ transformation\ (rigid\ actually)\ that\ }}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \textcolor{comment}{//\ takes\ relative\ coordinates\ and\ tramsforms\ them\ into\ world\ 3d}}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \textcolor{comment}{//\ coordinates:\ moves\ the\ camera\ into\ the\ scene.}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ Eigen::Affine3d\ affine()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ an\ Affine\ transformation\ (rigid\ actually)\ that\ puts\ the\ takes\ a}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \textcolor{comment}{//\ world\ 3d\ coordinate\ and\ transforms\ it\ into\ the\ relative\ camera}}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \textcolor{comment}{//\ coordinates:\ moves\ the\ scene\ in\ front\ of\ the\ camera.}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \textcolor{comment}{//\ Note:}}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ gluLookAt(}}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ eye()(0),\ eye()(1),\ eye()(2),}}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ at()(0),\ at()(1),\ at()(2),}}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ up()(0),\ up()(1),\ up()(2));}}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \textcolor{comment}{//\ Is\ equivalent\ to}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ glMultMatrixd(camera.inverse().matrix().data());}}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \textcolor{comment}{//\ See\ also:\ affine,\ eye,\ at,\ up}}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ Eigen::Affine3d\ inverse()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \textcolor{comment}{//\ Returns\ world\ coordinates\ position\ of\ center\ or\ "{}eye"{}\ of\ camera.}}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ Eigen::Vector3d\ eye()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \textcolor{comment}{//\ Returns\ world\ coordinate\ position\ of\ a\ point\ "{}eye"{}\ is\ looking\ at.}}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ Eigen::Vector3d\ at()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \textcolor{comment}{//\ Returns\ world\ coordinate\ unit\ vector\ of\ "{}up"{}\ vector}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ Eigen::Vector3d\ up()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \textcolor{comment}{//\ Return\ top\ right\ corner\ of\ unit\ plane\ in\ relative\ coordinates,\ that\ is}}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \textcolor{comment}{//\ (w/2,h/2,1)}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ Eigen::Vector3d\ unit\_plane()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \textcolor{comment}{//\ Move\ dv\ in\ the\ relative\ coordinate\ frame\ of\ the\ camera\ (move\ the\ FPS)}}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \textcolor{comment}{//\ Inputs:}}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ dv\ \ (x,y,z)\ displacement\ vector}}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ dolly(\textcolor{keyword}{const}\ Eigen::Vector3d\ \&\ dv);}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \textcolor{comment}{//\ "{}Scale\ zoom"{}:\ Move\ \`{}eye`,\ but\ leave\ \`{}at`}}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \textcolor{comment}{//\ Input:}}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ s\ \ amount\ to\ scale\ distance\ to\ at}}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ push\_away(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ s);}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \textcolor{comment}{//\ Aka\ "{}Hitchcock"{},\ "{}Vertigo"{},\ "{}Spielberg"{}\ or\ "{}Trombone"{}\ zoom:}}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \textcolor{comment}{//\ simultaneously\ dolly\ while\ changing\ angle\ so\ that\ \`{}at`\ not\ only\ stays}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \textcolor{comment}{//\ put\ in\ relative\ coordinates\ but\ also\ projected\ coordinates.\ That\ is}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{comment}{//\ Inputs:}}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ da\ \ change\ in\ angle\ in\ degrees}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ dolly\_zoom(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ da);}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \textcolor{comment}{//\ Turn\ around\ eye\ so\ that\ rotation\ is\ now\ q}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \textcolor{comment}{//\ Inputs:}}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ q\ \ new\ rotation\ as\ quaternion}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ turn\_eye(\textcolor{keyword}{const}\ Eigen::Quaterniond\ \&\ q);}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \textcolor{comment}{//\ Orbit\ around\ at\ so\ that\ rotation\ is\ now\ q}}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \textcolor{comment}{//\ Inputs:}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ q\ \ new\ rotation\ as\ quaternion}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ orbit(\textcolor{keyword}{const}\ Eigen::Quaterniond\ \&\ q);}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \textcolor{comment}{//\ Rotate\ and\ translate\ so\ that\ camera\ is\ situated\ at\ "{}eye"{}\ looking\ at\ "{}at"{}}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \textcolor{comment}{//\ with\ "{}up"{}\ pointing\ up.}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \textcolor{comment}{//\ Inputs:}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ eye\ \ (x,y,z)\ coordinates\ of\ eye\ position}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ at\ \ \ (x,y,z)\ coordinates\ of\ at\ position}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ up\ \ \ (x,y,z)\ coordinates\ of\ up\ vector}}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ look\_at(}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Vector3d\ \&\ eye,}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Vector3d\ \&\ at,}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Vector3d\ \&\ up);}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ Needed\ any\ time\ Eigen\ Structures\ are\ used\ as\ class\ members}}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{comment}{//\ http://eigen.tuxfamily.org/dox-\/devel/group\_\_TopicStructHavingEigenMembers.html}}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ EIGEN\_MAKE\_ALIGNED\_OPERATOR\_NEW}
\DoxyCodeLine{00146\ \ \ \};}
\DoxyCodeLine{00147\ \}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \textcolor{comment}{//\ Implementation}}
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{PI_8h}{PI.h}}"{}}}
\DoxyCodeLine{00151\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{EPS_8h}{EPS.h}}"{}}}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00153\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00154\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \textcolor{keyword}{inline}\ igl::Camera::Camera():}
\DoxyCodeLine{00157\ \ \ m\_angle(45.0),m\_aspect(1),m\_near(1e-\/2),m\_far(100),m\_at\_dist(1),}
\DoxyCodeLine{00158\ \ \ m\_orthographic(false),}
\DoxyCodeLine{00159\ \ \ m\_rotation\_conj(1,0,0,0),}
\DoxyCodeLine{00160\ \ \ m\_translation(0,0,1)}
\DoxyCodeLine{00161\ \{}
\DoxyCodeLine{00162\ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \textcolor{keyword}{inline}\ Eigen::Matrix4d\ igl::Camera::projection()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00165\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00166\ \ \ Eigen::Matrix4d\ P;}
\DoxyCodeLine{00167\ \ \ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{00168\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ far\ =\ m\_at\_dist\ +\ m\_far;}
\DoxyCodeLine{00169\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ near\ =\ m\_near;}
\DoxyCodeLine{00170\ \ \ \textcolor{comment}{//\ http://stackoverflow.com/a/3738696/148668}}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordflow}{if}(m\_orthographic)}
\DoxyCodeLine{00172\ \ \ \{}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ f\ =\ 0.5;}
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ left\ =\ -\/f*m\_aspect;}
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ right\ =\ f*m\_aspect;}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ bottom\ =\ -\/f;}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ top\ =\ f;}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ tx\ =\ (right+left)/(right-\/left);}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ ty\ =\ (top+bottom)/(top-\/bottom);}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ tz\ =\ (far+near)/(far-\/near);}
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ z\_fix\ =\ 0.5\ /m\_at\_dist\ /\ tan(m\_angle*0.5\ *\ (\mbox{\hyperlink{namespaceigl_af3c65fcb2a063b19e572a9d982b5dcdc}{igl::PI}}/180.)\ );}
\DoxyCodeLine{00182\ \ \ \ \ P<<}
\DoxyCodeLine{00183\ \ \ \ \ \ \ z\_fix*2./(right-\/left),\ 0,\ 0,\ -\/tx,}
\DoxyCodeLine{00184\ \ \ \ \ \ \ 0,\ z\_fix*2./(top-\/bottom),\ 0,\ -\/ty,}
\DoxyCodeLine{00185\ \ \ \ \ \ \ 0,\ 0,\ -\/z\_fix*2./(far-\/near),\ \ -\/tz,}
\DoxyCodeLine{00186\ \ \ \ \ \ \ 0,\ 0,\ 0,\ 1;}
\DoxyCodeLine{00187\ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00188\ \ \ \{}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ yScale\ =\ tan(PI*0.5\ -\/\ 0.5*m\_angle*PI/180.);}
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{comment}{//\ http://stackoverflow.com/a/14975139/148668}}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ xScale\ =\ yScale/m\_aspect;}
\DoxyCodeLine{00192\ \ \ \ \ P<<\ }
\DoxyCodeLine{00193\ \ \ \ \ \ \ xScale,\ 0,\ 0,\ 0,}
\DoxyCodeLine{00194\ \ \ \ \ \ \ 0,\ yScale,\ 0,\ 0,}
\DoxyCodeLine{00195\ \ \ \ \ \ \ 0,\ 0,\ -\/(far+near)/(far-\/near),\ -\/1,}
\DoxyCodeLine{00196\ \ \ \ \ \ \ 0,\ 0,\ -\/2.*near*far/(far-\/near),\ 0;}
\DoxyCodeLine{00197\ \ \ \ \ P\ =\ P.transpose().eval();}
\DoxyCodeLine{00198\ \ \ \}}
\DoxyCodeLine{00199\ \ \ \textcolor{keywordflow}{return}\ P;}
\DoxyCodeLine{00200\ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \textcolor{keyword}{inline}\ Eigen::Affine3d\ igl::Camera::affine()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00203\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00204\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00205\ \ \ Affine3d\ t\ =\ Affine3d::Identity();}
\DoxyCodeLine{00206\ \ \ t.rotate(m\_rotation\_conj.conjugate());}
\DoxyCodeLine{00207\ \ \ t.translate(m\_translation);}
\DoxyCodeLine{00208\ \ \ \textcolor{keywordflow}{return}\ t;}
\DoxyCodeLine{00209\ \}}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \textcolor{keyword}{inline}\ Eigen::Affine3d\ igl::Camera::inverse()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00212\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00213\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00214\ \ \ Affine3d\ t\ =\ Affine3d::Identity();}
\DoxyCodeLine{00215\ \ \ t.translate(-\/m\_translation);}
\DoxyCodeLine{00216\ \ \ t.rotate(m\_rotation\_conj);}
\DoxyCodeLine{00217\ \ \ \textcolor{keywordflow}{return}\ t;}
\DoxyCodeLine{00218\ \}}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \textcolor{keyword}{inline}\ Eigen::Vector3d\ igl::Camera::eye()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00221\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00222\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00223\ \ \ \textcolor{keywordflow}{return}\ affine()\ *\ Vector3d(0,0,0);}
\DoxyCodeLine{00224\ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \textcolor{keyword}{inline}\ Eigen::Vector3d\ igl::Camera::at()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00227\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00228\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00229\ \ \ \textcolor{keywordflow}{return}\ affine()\ *\ (Vector3d(0,0,-\/1)*m\_at\_dist);}
\DoxyCodeLine{00230\ \}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \textcolor{keyword}{inline}\ Eigen::Vector3d\ igl::Camera::up()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00233\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00234\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00235\ \ \ Affine3d\ t\ =\ Affine3d::Identity();}
\DoxyCodeLine{00236\ \ \ t.rotate(m\_rotation\_conj.conjugate());}
\DoxyCodeLine{00237\ \ \ \textcolor{keywordflow}{return}\ t\ *\ Vector3d(0,1,0);}
\DoxyCodeLine{00238\ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \textcolor{keyword}{inline}\ Eigen::Vector3d\ igl::Camera::unit\_plane()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00241\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00242\ \ \ \textcolor{comment}{//\ Distance\ of\ center\ pixel\ to\ eye}}
\DoxyCodeLine{00243\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ d\ =\ 1.0;}
\DoxyCodeLine{00244\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ a\ =\ m\_aspect;}
\DoxyCodeLine{00245\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ theta\ =\ m\_angle*\mbox{\hyperlink{namespaceigl_af3c65fcb2a063b19e572a9d982b5dcdc}{PI}}/180.;}
\DoxyCodeLine{00246\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ w\ =}
\DoxyCodeLine{00247\ \ \ \ \ 2.*sqrt(-\/d*d/(a*a*pow(tan(0.5*theta),2.)-\/1.))*a*tan(0.5*theta);}
\DoxyCodeLine{00248\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ h\ =\ w/a;}
\DoxyCodeLine{00249\ \ \ \textcolor{keywordflow}{return}\ Eigen::Vector3d(w*0.5,h*0.5,-\/d);}
\DoxyCodeLine{00250\ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ igl::Camera::dolly(\textcolor{keyword}{const}\ Eigen::Vector3d\ \&\ dv)}
\DoxyCodeLine{00253\ \{}
\DoxyCodeLine{00254\ \ \ m\_translation\ +=\ dv;}
\DoxyCodeLine{00255\ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ igl::Camera::push\_away(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ s)}
\DoxyCodeLine{00258\ \{}
\DoxyCodeLine{00259\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00260\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{00261\ \ \ Vector3d\ old\_at\ =\ at();}
\DoxyCodeLine{00262\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00263\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ old\_at\_dist\ =\ m\_at\_dist;}
\DoxyCodeLine{00264\ \ \ m\_at\_dist\ =\ old\_at\_dist\ *\ s;}
\DoxyCodeLine{00265\ \ \ dolly(Vector3d(0,0,1)*(m\_at\_dist\ -\/\ old\_at\_dist));}
\DoxyCodeLine{00266\ \ \ assert((old\_at-\/at()).squaredNorm()\ <\ DOUBLE\_EPS);}
\DoxyCodeLine{00267\ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ igl::Camera::dolly\_zoom(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ da)}
\DoxyCodeLine{00270\ \{}
\DoxyCodeLine{00271\ \ \ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{00272\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00273\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{00274\ \ \ Vector3d\ old\_at\ =\ at();}
\DoxyCodeLine{00275\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00276\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ old\_angle\ =\ m\_angle;}
\DoxyCodeLine{00277\ \ \ \textcolor{keywordflow}{if}(old\_angle\ +\ da\ <\ \mbox{\hyperlink{Camera_8h_a2ab57b8cb5c90de83b81ffe934961c00}{IGL\_CAMERA\_MIN\_ANGLE}})}
\DoxyCodeLine{00278\ \ \ \{}
\DoxyCodeLine{00279\ \ \ \ \ m\_orthographic\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00280\ \ \ \}\textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(old\_angle\ +\ da\ >\ \mbox{\hyperlink{Camera_8h_a2ab57b8cb5c90de83b81ffe934961c00}{IGL\_CAMERA\_MIN\_ANGLE}})}
\DoxyCodeLine{00281\ \ \ \{}
\DoxyCodeLine{00282\ \ \ \ \ m\_orthographic\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00283\ \ \ \}}
\DoxyCodeLine{00284\ \ \ \textcolor{keywordflow}{if}(!m\_orthographic)}
\DoxyCodeLine{00285\ \ \ \{}
\DoxyCodeLine{00286\ \ \ \ \ m\_angle\ +=\ da;}
\DoxyCodeLine{00287\ \ \ \ \ m\_angle\ =\ \mbox{\hyperlink{namespaceigl_aea356ce5149b60ed9d36e9f7a94db372}{min}}(89.,\mbox{\hyperlink{namespaceigl_a406b1c228d9a40c7c25062de5c6e20c9}{max}}(\mbox{\hyperlink{Camera_8h_a2ab57b8cb5c90de83b81ffe934961c00}{IGL\_CAMERA\_MIN\_ANGLE}},m\_angle));}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{comment}{//\ change\ in\ distance}}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ s\ =\ }
\DoxyCodeLine{00290\ \ \ \ \ \ \ (2.*tan(old\_angle/2./180.*\mbox{\hyperlink{namespaceigl_af3c65fcb2a063b19e572a9d982b5dcdc}{igl::PI}}))\ /}
\DoxyCodeLine{00291\ \ \ \ \ \ \ (2.*tan(m\_angle/2./180.*\mbox{\hyperlink{namespaceigl_af3c65fcb2a063b19e572a9d982b5dcdc}{igl::PI}}))\ ;}
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ old\_at\_dist\ =\ m\_at\_dist;}
\DoxyCodeLine{00293\ \ \ \ \ m\_at\_dist\ =\ old\_at\_dist\ *\ s;}
\DoxyCodeLine{00294\ \ \ \ \ dolly(Vector3d(0,0,1)*(m\_at\_dist\ -\/\ old\_at\_dist));}
\DoxyCodeLine{00295\ \ \ \ \ assert((old\_at-\/at()).squaredNorm()\ <\ DOUBLE\_EPS);}
\DoxyCodeLine{00296\ \ \ \}}
\DoxyCodeLine{00297\ \}}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ igl::Camera::turn\_eye(\textcolor{keyword}{const}\ Eigen::Quaterniond\ \&\ q)}
\DoxyCodeLine{00300\ \{}
\DoxyCodeLine{00301\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00302\ \ \ Vector3d\ old\_eye\ =\ eye();}
\DoxyCodeLine{00303\ \ \ \textcolor{comment}{//\ eye\ should\ be\ fixed}}
\DoxyCodeLine{00304\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00305\ \ \ \textcolor{comment}{//\ eye\_1\ =\ R\_1\ *\ t\_1\ =\ eye\_0}}
\DoxyCodeLine{00306\ \ \ \textcolor{comment}{//\ t\_1\ =\ R\_1'\ *\ eye\_0}}
\DoxyCodeLine{00307\ \ \ m\_rotation\_conj\ =\ q.conjugate();}
\DoxyCodeLine{00308\ \ \ m\_translation\ =\ m\_rotation\_conj\ *\ old\_eye;}
\DoxyCodeLine{00309\ \ \ assert((old\_eye\ -\/\ eye()).squaredNorm()\ <\ DOUBLE\_EPS);}
\DoxyCodeLine{00310\ \}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ igl::Camera::orbit(\textcolor{keyword}{const}\ Eigen::Quaterniond\ \&\ q)}
\DoxyCodeLine{00313\ \{}
\DoxyCodeLine{00314\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00315\ \ \ Vector3d\ old\_at\ =\ at();}
\DoxyCodeLine{00316\ \ \ \textcolor{comment}{//\ at\ should\ be\ fixed}}
\DoxyCodeLine{00317\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00318\ \ \ \textcolor{comment}{//\ at\_1\ =\ R\_1\ *\ t\_1\ -\/\ R\_1\ *\ z\ =\ at\_0}}
\DoxyCodeLine{00319\ \ \ \textcolor{comment}{//\ t\_1\ =\ R\_1'\ *\ (at\_0\ +\ R\_1\ *\ z)}}
\DoxyCodeLine{00320\ \ \ m\_rotation\_conj\ =\ q.conjugate();}
\DoxyCodeLine{00321\ \ \ m\_translation\ =\ }
\DoxyCodeLine{00322\ \ \ \ \ m\_rotation\_conj\ *\ }
\DoxyCodeLine{00323\ \ \ \ \ \ \ (old\_at\ +\ }
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ m\_rotation\_conj.conjugate()\ *\ Vector3d(0,0,1)\ *\ m\_at\_dist);}
\DoxyCodeLine{00325\ \ \ assert((old\_at\ -\/\ at()).squaredNorm()\ <\ DOUBLE\_EPS);}
\DoxyCodeLine{00326\ \}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ igl::Camera::look\_at(}
\DoxyCodeLine{00329\ \ \ \textcolor{keyword}{const}\ Eigen::Vector3d\ \&\ eye,}
\DoxyCodeLine{00330\ \ \ \textcolor{keyword}{const}\ Eigen::Vector3d\ \&\ at,}
\DoxyCodeLine{00331\ \ \ \textcolor{keyword}{const}\ Eigen::Vector3d\ \&\ up)}
\DoxyCodeLine{00332\ \{}
\DoxyCodeLine{00333\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00334\ \ \ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{00335\ \ \ \textcolor{comment}{//\ http://www.opengl.org/sdk/docs/man2/xhtml/gluLookAt.xml}}
\DoxyCodeLine{00336\ \ \ \textcolor{comment}{//\ Normalize\ vector\ from\ at\ to\ eye}}
\DoxyCodeLine{00337\ \ \ Vector3d\ F\ =\ eye-\/at;}
\DoxyCodeLine{00338\ \ \ m\_at\_dist\ =\ F.norm();}
\DoxyCodeLine{00339\ \ \ F.normalize();}
\DoxyCodeLine{00340\ \ \ \textcolor{comment}{//\ Project\ up\ onto\ plane\ orthogonal\ to\ F\ and\ normalize}}
\DoxyCodeLine{00341\ \ \ assert(up.cross(F).norm()\ >\ DOUBLE\_EPS\ \&\&\ \textcolor{stringliteral}{"{}(eye-\/at)\ x\ up\ ≈\ 0"{}});}
\DoxyCodeLine{00342\ \ \ \textcolor{keyword}{const}\ Vector3d\ proj\_up\ =\ (up-\/(up.dot(F))*F).normalized();}
\DoxyCodeLine{00343\ \ \ Quaterniond\ a,b;}
\DoxyCodeLine{00344\ \ \ a.setFromTwoVectors(Vector3d(0,0,-\/1),-\/F);}
\DoxyCodeLine{00345\ \ \ b.setFromTwoVectors(a*Vector3d(0,1,0),proj\_up);}
\DoxyCodeLine{00346\ \ \ m\_rotation\_conj\ =\ (b*a).conjugate();}
\DoxyCodeLine{00347\ \ \ m\_translation\ =\ m\_rotation\_conj\ *\ eye;}
\DoxyCodeLine{00348\ \ \ \textcolor{comment}{//cout<<"{}m\_at\_dist:\ "{}<<m\_at\_dist<<endl;}}
\DoxyCodeLine{00349\ \ \ \textcolor{comment}{//cout<<"{}proj\_up:\ "{}<<proj\_up.transpose()<<endl;}}
\DoxyCodeLine{00350\ \ \ \textcolor{comment}{//cout<<"{}F:\ "{}<<F.transpose()<<endl;}}
\DoxyCodeLine{00351\ \ \ \textcolor{comment}{//cout<<"{}eye():\ "{}<<this-\/>eye().transpose()<<endl;}}
\DoxyCodeLine{00352\ \ \ \textcolor{comment}{//cout<<"{}at():\ "{}<<this-\/>at().transpose()<<endl;}}
\DoxyCodeLine{00353\ \ \ \textcolor{comment}{//cout<<"{}eye()-\/at():\ "{}<<(this-\/>eye()-\/this-\/>at()).normalized().transpose()<<endl;}}
\DoxyCodeLine{00354\ \ \ \textcolor{comment}{//cout<<"{}eye-\/this-\/>eye():\ "{}<<(eye-\/this-\/>eye()).squaredNorm()<<endl;}}
\DoxyCodeLine{00355\ \ \ assert(\ \ \ \ \ \ \ \ \ \ \ (eye-\/this-\/>eye()).squaredNorm()\ <\ DOUBLE\_EPS);}
\DoxyCodeLine{00356\ \ \ \textcolor{comment}{//assert((F-\/(this-\/>eye()-\/this-\/>at()).normalized()).squaredNorm()\ <\ }}
\DoxyCodeLine{00357\ \ \ \textcolor{comment}{//\ \ DOUBLE\_EPS);}}
\DoxyCodeLine{00358\ \ \ assert(\ \ \ \ \ \ \ \ \ \ \ (at-\/this-\/>at()).squaredNorm()\ <\ DOUBLE\_EPS);}
\DoxyCodeLine{00359\ \ \ \textcolor{comment}{//assert(\ \ \ \ \ \ \ \ (proj\_up-\/this-\/>up()).squaredNorm()\ <\ DOUBLE\_EPS);}}
\DoxyCodeLine{00360\ \}}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
